<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Spin</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: #000;
        font-family: Arial, sans-serif;
      }

      .stage {
        position: fixed;
        inset: 0;
        background: #000;
        z-index: 1;
      }

      .stage video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .spin-btn {
        position: fixed;
        left: 50%;
        bottom: 2.5rem;
        transform: translateX(-50%);
        padding: 1.25rem 5.5rem;
        font-size: 1.75rem;
        font-weight: 800;
        background: #ffcb05;
        color: #000;
        border: none;
        border-radius: 3.75rem;
        box-shadow: 0 0 0.875rem rgba(0, 123, 255, 0.8);
        cursor: pointer;
        z-index: 10;
        white-space: nowrap;
        transition: transform 0.2s ease;
      }

      .spin-btn:hover {
        transform: translateX(-50%) scale(1.05);
      }
    </style>
  </head>

  <body>
    <div class="stage">
      <video
        id="video"
        playsinline
        preload="auto"
      ></video>
    </div>

    <button id="spinBtn" class="spin-btn">Free spin</button>

    <script>
      const video = document.getElementById("video");
      const btn = document.getElementById("spinBtn");

      const FINAL_URL = "https://bit.ly/3MtCRqZ";

      // 0 = preview (zadnja sekunda 1.mp4)
      // 1 = 1.mp4 pušten
      // 2 = 2.mp4 pušten
      // 3 = redirect
      let step = 0;
      let playing = false;

      // LOAD PREVIEW = POSLJEDNJA SEKUNDA PRVOG VIDEA
      video.src = "1.mp4";
      video.muted = true;

      video.addEventListener("loadedmetadata", () => {
        // idi na posljednju sekundu (sigurno, bez overflow-a)
        video.currentTime = Math.max(video.duration - 1, 0);
        video.pause();
      });

      btn.addEventListener("click", () => {
        if (playing) return;

        // PUSTI PRVI VIDEO OD POČETKA
        if (step === 0) {
          playing = true;
          video.muted = false;
          video.currentTime = 0;
          video.play();

          video.onended = () => {
            playing = false;
            step = 1;
          };
        }

        // PUSTI DRUGI VIDEO
        else if (step === 1) {
          playing = true;
          video.src = "2.mp4";
          video.currentTime = 0;
          video.play();

          video.onended = () => {
            // freeze zadnji frame
            video.pause();
            playing = false;
            step = 2;
            btn.textContent = "Continue";
          };
        }

        // REDIRECT
        else if (step === 2) {
          window.location.href = FINAL_URL;
        }
      });
    </script>
  </body>
</html>
